# -- Slurm compute nodes configuration

{{ $default_properties := .Values.slurm_config.nodes.default_properties }}

{{- range .Values.slurm_config.nodes.ranges }}
NodeName=DEFAULT {{ include "slurm.formatProperties" (merge .properties $default_properties) }}
{{- range (include "slurm.expandNodeRange" .spec | fromYamlArray) }}
{{ printf "NodeName=%v" . }}
{{- end }}
{{- end }}

MaxNodeCount=1000
{{- range .Values.slurm_config.nodes.sets }}
Nodeset={{ .name }} Feature={{ join "," (.features | default (list)) }}
{{- end }}

{{- range $node := .Values.slurm_config.nodes.individuals }}
NodeName={{ $node.name }} {{ include "slurm.formatProperties" (merge (omit $node "name") $default_properties) }}
{{- end }}
